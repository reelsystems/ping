{
  "_type": "audit-service",
  "auditServiceConfig": {
    "handlerForQueries": "json",
    "availableAuditEventHandlers": [
      "org.forgerock.audit.handlers.json.JsonAuditEventHandler",
      "org.forgerock.audit.handlers.csv.CsvAuditEventHandler",
      "org.forgerock.audit.handlers.syslog.SyslogAuditEventHandler"
    ],
    "filterPolicies": {
      "field": {
        "excludeIf": [],
        "includeIf": []
      }
    }
  },
  "eventHandlers": [
    {
      "_id": "json-handler",
      "class": "org.forgerock.audit.handlers.json.JsonAuditEventHandler",
      "config": {
        "name": "json",
        "topics": [
          "access",
          "activity",
          "authentication",
          "config"
        ],
        "logDirectory": "/opt/am/data/audit",
        "rotationPolicy": {
          "rotationEnabled": true,
          "rotationFilePrefix": "audit-",
          "rotationFileSuffix": ".log",
          "rotationInterval": "1 day",
          "rotationTimes": ["00:00"]
        },
        "retentionPolicy": {
          "maxNumberOfHistoryFiles": 365,
          "minFreeSpaceRequired": "1 GB",
          "maxDiskSpaceToUse": "100 GB"
        },
        "buffering": {
          "enabled": true,
          "maxSize": 10000,
          "writeInterval": "1 second"
        },
        "fileRotation": {
          "rotationEnabled": true,
          "maxFileSize": "100 MB"
        }
      }
    },
    {
      "_id": "syslog-handler",
      "class": "org.forgerock.audit.handlers.syslog.SyslogAuditEventHandler",
      "config": {
        "name": "syslog",
        "enabled": false,
        "topics": [
          "access",
          "authentication"
        ],
        "protocol": "TCP",
        "host": "syslog-server.devnetwork.dev",
        "port": 514,
        "facility": "LOCAL0",
        "buffering": {
          "enabled": true,
          "maxSize": 5000
        },
        "severityFieldMappings": [
          {
            "topic": "authentication",
            "field": "result",
            "valueMappings": {
              "SUCCESSFUL": "INFORMATIONAL",
              "FAILED": "ERROR"
            }
          },
          {
            "topic": "access",
            "field": "response.statusCode",
            "valueMappings": {
              "200": "INFORMATIONAL",
              "401": "WARNING",
              "403": "WARNING",
              "500": "ERROR"
            }
          }
        ]
      }
    }
  ],
  "eventTopics": {
    "access": {
      "events": [
        "AM-ACCESS-ATTEMPT",
        "AM-ACCESS-OUTCOME"
      ]
    },
    "activity": {
      "events": [
        "AM-SESSION-CREATED",
        "AM-SESSION-IDLE",
        "AM-SESSION-MAX",
        "AM-SESSION-LOGOUT",
        "AM-SESSION-DESTROYED"
      ]
    },
    "authentication": {
      "events": [
        "AM-AUTHENTICATION-INITIATED",
        "AM-AUTHENTICATION-MODULE-SELECTION",
        "AM-AUTHENTICATION-SUCCESS",
        "AM-AUTHENTICATION-FAILED",
        "AM-AUTHENTICATION-LOGOUT"
      ]
    },
    "config": {
      "events": [
        "AM-CONFIG-CHANGE"
      ]
    }
  }
}
